<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
	<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet" />
	<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
	<!-- CSS style -->
	<link rel="stylesheet" type="text/css"  href="./css/style.css" />
	<title>Add Categories - Second-hands Store Website </title>
</head>

<body>
	<div class="container">
		<div id="Header">
		</div>
		<div id="navbar"></div>
		<div class="card mt-3">
			<div class="card-header">Add categories</div>
			<div class="card-body">
				<form id="addCategories" action="categories_add_process.html" method="post" class="needs-validation"
					novalidate>
					<div class="mb-3">
						<label for="CategoryID" class="form-label">Category id</label>
						<input type="text" class="form-control" id="CategoryID" name="CategoryID" required />
						<div class="invalid-feedback">Category id cannot be left blank.</div>
					</div>

					<div class="mb-3">
						<label for="CategoryName" class="form-label">Category name</label>
						<input type="text" class="form-control" id="CategoryName" name="CategoryName" required />
						<div class="invalid-feedback">Category name cannot be left blank.</div>
					</div>

					<button type="submit" class="btn btn-primary"><i class="bi bi-floppy"></i> Add to Database</button>
				</form>
			</div>
		</div>
		<div id="footer"></div>
	</div>


	<script type="module" src="inc/config.js"></script>

	<script type="module">
		//Connect to Supabase
		import { supabase } from './inc/config.js';
		/*import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';

		const SUPABASE_URL = 'https://tyltpbedtadxhpmgrgxa.supabase.co';  // URL
		const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InR5bHRwYmVkdGFkeGhwbWdyZ3hhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDQzNzE5NzEsImV4cCI6MjA1OTk0Nzk3MX0.xP7vg1yn4GLReCpO7mYU6qnnq2rw4aekIAkJKcaj0xk';    //anon public

		const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);*/

		$(function () {
			/*'use strict';*/
			$('#navbar').load('inc/navbar.html');
			$('#footer').load('inc/footer.html');
		});

		//const forms = document.querySelectorAll('.needs-validation');
		const form = document.getElementById('addCategories');

		//Array.from(forms).forEach(form => {
		form.addEventListener('submit', async (event) => {
			event.preventDefault();
			event.stopPropagation();
			form.classList.add('was-validated');

			if (!form.checkValidity()) {
				return;
			}

			const categoriesID = document.getElementById('CategoryID').value.trim();
			const categoriesName = document.getElementById('CategoryName').value.trim();

			/*const { data, error } = await supabase
				.from('categories')
				.insert([
					{
						id: categoriesID,
						name: categoriesName
					}
				]);

			if (error) {
				alert('Error adding data: ' + error.message);
			} else {
				alert('Add categories successfully !');
				window.location.href = 'categories.html'; //Move to categories page
			}*/
			// Thay vì insert vào database ở đây, ta lưu vào localStorage
			localStorage.setItem('categoryID', categoriesID);
			localStorage.setItem('categoryName', categoriesName);

			window.location.href = 'categories_add_process.html'; // Move to process page

		});
	</script>

</body>

</html>